{
  "hostfile": "/gpfs/mira-home/xduan7/projects/scalable-transformer/scripts/.hostfile",
  "data_path": "/gpfs/mira-home/xduan7/projects/scalable-transformer/data/processed/enwiki_text/gpt2/text_document",
  "vocab_file": "/gpfs/mira-home/xduan7/projects/scalable-transformer/data/raw/enwiki_vocab/gpt2-vocab.json",
  "merge_file": "/gpfs/mira-home/xduan7/projects/scalable-transformer/data/raw/enwiki_vocab/gpt2-merges.txt",
  "user_script": "/gpfs/mira-home/xduan7/projects/scalable-transformer/third-party/gpt-neox/pretrain_gpt2.py",
  "optimizer": {
    "type": "Adam",
    "params": {
      "lr": 0.0001,
      "betas": [0.9, 0.999],
      "eps": 1e-08
    }
  },
  "fp16": {
    "enabled": true,
    "loss_scale": 0,
    "loss_scale_window": 1000,
    "hysteresis": 2,
    "min_loss_scale": 1
  },
  "gradient_clipping": 1.0,
  "zero_optimization": {
    "stage": 0,
    "allgather_partitions": true,
    "allgather_bucket_size": 500000000,
    "overlap_comm": true,
    "reduce_scatter": true,
    "reduce_bucket_size": 500000000,
    "contiguous_gradients": true,
    "cpu_offload": false
  },
  "wall_clock_breakdown": true,
  "deepspeed_mpi": true,
  "gradient_accumulation_steps": 4,
  "train_micro_batch_size_per_gpu": 32,
  "precision": "fp16",
  "num_layers": 24,
  "hidden_size": 1024,
  "num_attention_heads": 16,
  "seq_length": 512,
  "max_position_embeddings": 512,
  "pos_emb": "rotary",
  "no_weight_tying": true,
  "attention_config": ["global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global", "global"],
  "sparsity_config": {},
  "scaled_upper_triang_masked_softmax_fusion": true,
  "bias_gelu_fusion": true,
  "lr_decay_style": "cosine",
  "lr_decay_iters": 320000,
  "optimizer_type": "Adam",
  "zero_stage": 0,
  "zero_reduce_scatter": true,
  "zero_contiguous_gradients": true,
  "zero_reduce_bucket_size": 500000000,
  "zero_allgather_bucket_size": 500000000,
  "lr": 0.0001,

  "data_impl": "mmap",
  "save_interval": 10000,
  "batch_size": 4,
  "train_iters": 320000,
  "eval_iters": 10,
  "keep_last_n_checkpoints": 4,
  "split": "949,50,1",

  "attention_dropout": 0.0,
  "hidden_dropout": 0.0,
  "weight_decay": 0.0,
  "checkpoint_activations": true,
  "synchronize_each_layer": true,
  "partition_activations": true,
  "gas": 1,
  "clip_grad": 1.0,
  "dynamic_loss_scale": true,
  "pipe_parallel_size": 1,
  "is_pipe_parallel": true,
  "wandb_group": "Vh7dWwZnMzWWEcqfoo8GaJ_ukgkr14y",
  "log_interval": 100

}